# WebClient configuration
holiday.api.base-url=https://date.nager.at/api/v3/
holiday.api.connect-timeout=5000
holiday.api.read-timeout=10000

# Cache type
spring.cache.type=redis

# Redis connection
spring.data.redis.host=redis
spring.data.redis.port=6379

# Time to live for cache entries: 1 day
spring.cache.redis.time-to-live=24h

# Disable caching null values
spring.cache.redis.cache-null-values=false

# Use key prefix (helpful to avoid collisions between multiple apps)
spring.cache.redis.use-key-prefix=true

# Log levels
logging.level.root=INFO
logging.level.org.springframework=INFO
logging.level.org.springframework.data.redis=DEBUG
logging.level.org.springframework.cache=DEBUG

# Expose actuator endpoints
management.metrics.enable.cache=true
management.endpoints.web.exposure.include=prometheus,metrics,health,info
management.endpoint.prometheus.enabled=true
management.endpoint.health.show-details=always

# ========================
# Resilience4j CircuitBreaker
# ========================
resilience4j.circuitbreaker.instances.holidayChecker.register-health-indicator=true
resilience4j.circuitbreaker.instances.holidayChecker.sliding-window-size=10
resilience4j.circuitbreaker.instances.holidayChecker.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.holidayChecker.wait-duration-in-open-state=10s
resilience4j.circuitbreaker.instances.holidayChecker.permitted-number-of-calls-in-half-open-state=3
resilience4j.circuitbreaker.instances.holidayChecker.automatic-transition-from-open-to-half-open-enabled=true

# ========================
# Resilience4j Retry
# ========================
resilience4j.retry.instances.holidayChecker.max-attempts=3
resilience4j.retry.instances.holidayChecker.wait-duration=500ms

# ========================
# Resilience4j RateLimiter
# ========================
resilience4j.ratelimiter.instances.holidayChecker.limit-for-period=5
resilience4j.ratelimiter.instances.holidayChecker.limit-refresh-period=1s
resilience4j.ratelimiter.instances.holidayChecker.timeout-duration=0

# ========================
# Resilience4j Bulkhead (concurrency control)
# ========================
resilience4j.bulkhead.instances.holidayChecker.max-concurrent-calls=5
resilience4j.bulkhead.instances.holidayChecker.max-wait-duration=0
